{% extends 'base.html.twig' %}
{% block title %}Sortie {{ sortie.nom }}{% endblock %}
{% block body %}
        <h1>{{ sortie.nom }}</h1>
    {% if(sortie.etat.id == 6) %}
        <div id="zone_annulation">
            <h2 id="sortie_annulee">Sortie annulée !</h2>
            <p>{{ sortie.motif }}</p>
        </div>
    {% endif %}
    <!-- Boucle dans la classe sorties -->
    <hr>
         <div>      <!--affichage des propriétés de la table sortie de la BDD-->
             <ul>
                <li><p>Nom de la sortie : {{ sortie.nom }} </p></li>
                <li><p>Organisateur de la sortie : {{ sortie.organisateur.username }} </p></li>
                <li><p>Date et heure de la sortie : {{ sortie.dateHeureDebut | date ('Y-m-d H: i: s') }}</p></li>
                <li><p>Nombre de place maximum : {{ sortie.nbInscriptionsMax }} </p></li>
                <li><p>Date Limite d'inscription : {{ sortie.dateLimiteInscription | date ('Y-m-d H: i: s') }} </p></li>
                <li><p> Durée de la sortie :
                     {% if sortie.duree > 60 %}
                         {% set heures = sortie.duree//60 %}
                         {% set minutes = sortie.duree%60 %}
                         {{ heures }} heure(s) et {{ minutes }} minute(s)
                     {% else %}
                        {{ sortie.duree }} minute(s)
                     {% endif %}
                </p></li>
                <li><p>Description et infos : {{ sortie.infosSortie }} </p></li>
             </ul>
         </div>
    <hr>
        <div>       <!--affichage des propriétés de la table campus de la BDD-->
            <ul>
                <li><p>Campus : {{ sortie.campus.nom }}</p></li>
                <li><p>Lieu : {{ sortie.lieu.ville.nom }} </p></li>
                <li><p>Code Postal : {{ sortie.lieu.ville.codePostal }}</p></li>
                <li><p>Latitude : {{ sortie.lieu.latitude }}</p></li>
                <li><p>Longitude : {{ sortie.lieu.longitude }}</p></li>
            </ul>
        </div>
    <hr>
        <div>   <!--affichage du nombre de participants table sortie de la BDD avec une boucle-->
            <table>
                <h4>Liste des particpants</h4>
                    <tr><td>Pseudo</td><td>Nom</td></tr>

                        {% for participant in sortie.participants %}
                            <div class ="listParticipant">
                                <tr>
                                    <td>
                                        <a
                                            href="{{path('user_detailProfil', { id: participant.id } ) }}"
                                            title="Profil de {{ participant.username }}"
                                        >
                                                {{ participant.username }}
                                        </a>
                                    </td>
                                    <td>
                                        {{ participant.nom }}
                                    </td>
                                </tr>

                            </div>
                     {% endfor %}
            </table>
            {% if sortie.participants| length == 0 %}<p>Pas de participants !</p>{% endif %}
        </div>
<br>

    <!-- si user = organisateur -->
    {% if sortie.organisateur.id == app.user.id and sortie.etat.id != 4 and sortie.etat.id != 5 and sortie.etat.id != 6 and sortie.etat.id != 7 %}
        <a href="{{path('sortie_afficheAnnulationSortie', { id: sortie.id } ) }}">Annuler la sortie</a>
    {% endif %}

    {% if (sortie.organisateur.id == app.user.id) and (sortie.etat.id == 1 or sortie.etat.id == 2 or sortie.etat.id == 3)%}
        <a href="">Modifier</a>
    {% endif %}
    <!-- si user = organisateur et sortie crée-->
    {% if sortie.organisateur is same as(app.user) and sortie.etat.id == 1%}

        <a href="{{path('sortie_publication', { id: sortie.id } ) }}">Publier la sortie</a>

    {% endif %}

    <!-- si user =/= organisateur -->

    <!-- si user inscrit -->
    {% if app.user in sortie.participants and (sortie.etat.id == 2 or sortie.etat.id == 3) %}
        <a href="{{path('sortie_desinscription', { id: sortie.id } ) }}">se desincrire</a>
    {% endif %}

    <!-- si user pas inscrit -->
    {% if app.user not in sortie.participants and sortie.etat.id == 2 and sortie.participants | length < sortie.nbInscriptionsMax%}
        <a href="{{path('sortie_inscription', { id: sortie.id } ) }}">s'inscrire à la sortie</a>
    {% endif %}




{% endblock %}